name: ontology

services:

  # ‚úÖ neo4j
  neo4j_ontology:
    image: neo4j:5.26.4-community
    container_name: neo4j_ontology
    restart: unless-stopped
    ports:
      - "${NEO4J_HTTP_PORT}:7474"
      - "${NEO4J_BOLT_PORT}:7687"
    environment:   # üìç [CAVEAT] Set env_file may cause config error due to username/password
      - NEO4J_apoc_export_file_enabled=true
      - NEO4J_apoc_import_file_enabled=true
      - NEO4J_apoc_import_file_use__neo4j__config=true
      - NEO4J_dbms_security_procedures_unrestricted=apoc.*
      - NEO4J_AUTH=${NEO4J_AUTH}
      - NEO4J_PLUGINS=["apoc"]
    volumes:
      - /data/neo4j/ontology/conf:/var/lib/neo4j/conf
      - /data/neo4j/ontology/data:/data
      - /data/neo4j/ontology/plugins:/plugins
      - /data/neo4j/ontology/logs:/logs
    networks:
      - ontology_net


  # ‚úÖ qdrant
  qdrant_ontology: 
    image: qdrant/qdrant
    container_name: qdrant_ontology
    restart: unless-stopped
    ports:
      - "${QDRANT_PORT}:6333"
    volumes:
      - /data/qdrant/ontology/storage:/qdrant/storage
    networks:
      - ontology_net


  # ‚úÖ minio
  minio_ontology:
    image: minio/minio
    container_name: minio_ontology
    restart: unless-stopped
    ports:
      - "${MINIO_PORT}:9000"
      - "${MINIO_CONSOLE_PORT}:9090"
    environment:
      - MINIO_ROOT_USER=${MINIO_ROOT_USER}
      - MINIO_ROOT_PASSWORD=${MINIO_ROOT_PASSWORD}
    volumes:
      - /data/minio/ontology/config:/root/.minio
      - /data/minio/ontology/data1:/data1
      - /data/minio/ontology/data2:/data2
      - /data/minio/ontology/data3:/data3
      - /data/minio/ontology/data4:/data4
    command: server /data{1...4} --console-address ":9090"
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9000/minio/health/live"]
      interval: 30s
      timeout: 20s
      retries: 3
    networks:
      - ontology_net



  # ‚úÖ redis
  redis_ontology:
      image: redis
      container_name: redis_ontology
      restart: unless-stopped
      ports:
        - "${REDIS_PORT}:6379"
      volumes:
        - /data/redis/ontology/data:/data
      command: ["redis-server", "--save", "60", "1", "--loglevel", "warning"]
      environment:
        - ALLOW_EMPTY_PASSWORD=yes
      networks:
        - ontology_net


  # ‚úÖ redis insight
  redis_insight_ontology:
      image: redislabs/redisinsight:latest
      container_name: redis_insight_ontology
      restart: unless-stopped
      ports:
        - "${REDIS_INSIGHT_PORT}:5540"
      volumes:
        - /data/redis_insight/ontology:/data
      networks:
        - ontology_net






networks:
  ontology_net:


